LOCALDIR         = $(notdir $(PWD))
TEMPLATEBASENAME = $(basename $(shell ls *.template))

DESTDIR          = $(TESTBENCH)/$(LOCALDIR)
SOURCEDIR        = $(ROIPAC_TESTDATA)/$(LOCALDIR)
DEMDIR           = $(TESTBENCH)/$(LOCALDIR)/ROIPAC_DEMS

clean:
	rm -fr  $(DESTDIR)

preparenogetsar:
	mkdir -p $(DESTDIR)
	ln -s $(SOURCEDIR)/* $(DESTDIR)
	cp $(TEMPLATEBASENAME).template $(DESTDIR)

prepare:
	mkdir -p $(DESTDIR)
	cp $(TEMPLATEBASENAME).template $(DESTDIR)

process:
	cd $(DESTDIR); $(INT_SCR)/process_rsmas.pl $(DESTDIR)/$(TEMPLATEBASENAME).template WorkDir=$(DESTDIR)

processnogetsar:
	cd $(DESTDIR); $(INT_SCR)/process_rsmas.pl $(DESTDIR)/$(TEMPLATEBASENAME).template WorkDir=$(DESTDIR) --nogetsar

display: 
	summary.pl $(DESTDIR)/process/$(TEMPLATEBASENAME)/DONE/P*

all:
	make clean
	make prepare
	make process
	make display
	make clean

allnogetsar:
	make clean
	make preparenogetsar
	make processnogetsar
	make display
	make clean

allnoclean:
	make clean
	make prepare
	make process
	make display

allnogetsarnoclean:
	make clean
	make preparenogetsar
	make processnogetsar
	make display
